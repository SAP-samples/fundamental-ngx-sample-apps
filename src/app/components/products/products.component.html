<fd-layout-panel>
    <fd-layout-panel-header>
        <fd-layout-panel-head>
            <h2>{{productsPage.title}}</h2>
            <fd-layout-panel-description>{{productsPage.description}}</fd-layout-panel-description>
        </fd-layout-panel-head>
        <fd-layout-panel-actions>
            <button 
            [compact]="globalCompact"
            fd-button
            fdType="transparent"
            glyph="add"
            (click)="openCreateModal()">
            </button>
        </fd-layout-panel-actions>
    </fd-layout-panel-header>
    <fd-layout-panel-filters *ngIf="products">
      <fd-multi-input 
      [compact]="globalCompact"
      [dropdownValues]="products"
      [placeholder]="'Search here...'"
      [(ngModel)]="selected"
      (ngModelChange)="refresh()"
      [displayFn]="displayFunc">
      </fd-multi-input><span *ngFor="let item of selected; let i = index"></span>
      <!-- <fd-pagination
      [totalItems]="totalProducts"
      (pageChangeStart)="newPageClicked($event)"
      [itemsPerPage]="10"
      [currentPage]="1"
      ></fd-pagination> -->
    </fd-layout-panel-filters>
    <fd-layout-panel-body *ngIf="products">
      <fd-table-wrapper *ngIf="selected && dataSource">
        <table cdk-table [dataSource]="filteredDataSource" #table cdkDropList [cdkDropListData]="filteredDataSource" (cdkDropListDropped)="dropRow($event)">
                <tr cdk-header-row *cdkHeaderRowDef="columnHeaders"></tr>

            <tr cdk-row cdkDrag [cdkDragData]="row" *cdkRowDef="let row; columns: columnHeaders" style="cursor: grab;"></tr>

            <ng-container   cdkColumnDef="name">
                <th cdk-header-cell *cdkHeaderCellDef>{{columnHeaders[0] | titlecase}}</th> 
                <ng-container cdk-cell *cdkCellDef="let product">                       
                    <td>
                                {{product.name}}
                            <fd-inline-help [inlineHelpContentStyle]="{ 'background-color': 'var(--sapGroup_ContentBackground)', color: 'var(--sapTextColor)', 'border-color': 'var(--sapGroup_ContentBorderColor)'}" [placement]="'right'">
                                Information about {{product.name}}
                            </fd-inline-help>
                        </td>
                    </ng-container>                    
                </ng-container>

            <ng-container   cdkColumnDef="contact">
                <th cdk-header-cell *cdkHeaderCellDef>{{columnHeaders[1] | titlecase}}</th> 
                <ng-container cdk-cell *cdkCellDef="let product">                       
                    <td>
                        {{product.contact}}
                    </td>
                </ng-container>
            </ng-container>

            <ng-container   cdkColumnDef="lob">
                <th cdk-header-cell *cdkHeaderCellDef>{{columnHeaders[2] | uppercase}}</th>                            
                <ng-container cdk-cell *cdkCellDef="let product">                       
                    <td>
                    {{product.lob}}
                    </td>
                </ng-container>
            </ng-container>

            <ng-container   cdkColumnDef="user_number">
                <th cdk-header-cell *cdkHeaderCellDef>{{columnHeaders[3] | titlecase | snakeCase}}</th>
                <ng-container cdk-cell *cdkCellDef="let product">                       
                    <td>
                        {{product.user_number}}
                    </td>
                </ng-container>
            </ng-container>

            <ng-container  cdkColumnDef="status">
                <th cdk-header-cell *cdkHeaderCellDef>{{columnHeaders[4] | titlecase}}</th>
                <ng-container cdk-cell *cdkCellDef="let product">                       
                        <td>
                        <span fd-info-label [color]="product.status | statusToColor" modifier="pill"> {{product.status}} </span>
                    </td>
                </ng-container>
            </ng-container> 

            <ng-container   cdkColumnDef="edit">
                <th cdk-header-cell *cdkHeaderCellDef>{{columnHeaders[5] | titlecase}}</th>
                <ng-container cdk-cell *cdkCellDef="let product">                       
                      <td>
                        <button [compact]="globalCompact"
                        fd-button fdType="transparent" 
                        glyph="edit" 
                        (click)="openEditModal(product)">
                      </button>
                    </td>
                </ng-container>
            </ng-container>

            <ng-container   cdkColumnDef="remove">
                    <th cdk-header-cell *cdkHeaderCellDef >{{columnHeaders[6] | titlecase}}</th>
                    <ng-container cdk-cell *cdkCellDef="let product">                       
                          <td>
                            <button [compact]="globalCompact"
                            fd-button fdType="transparent" 
                            glyph="delete" 
                            (click)="openConfirmModal(product.name)">
                          </button>
                        </td>
                    </ng-container>
            </ng-container>
        </table>
    </fd-table-wrapper>
    </fd-layout-panel-body>
</fd-layout-panel>
<div *ngIf="!(products)"
      class="spinner-container">
    <fd-busy-indicator [loading]="true"></fd-busy-indicator>
</div>